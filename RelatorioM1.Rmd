---
title: "RelatorioM1"
author: "Rita, André, Camila, Antônio"
date: "2025-02-20"
cache: true
output: 
  pdf_document:
    fig_caption: true
    extra_dependencies: "subfig"
---

OBS: A apresentação da atividade deverá seguir as normas ABNT de apresentação de relatórios de pesquisa e as Normas de Apresentação Tabular.

## Sumário:

## Introdução:
* Incialmente explicar o que é o Sistema de Avaliação do Ensino Básico e como a Prova Brasil se insere neste sistema. (Ler documento Microdados Prova Brasil 2011 - Manual do Usuário disponível na plataforma)
* Explicar o que é a Prova Brasil e em particular a Prova Brasil de 2011. (Ler documento Microdados Prova Brasil 2011 - Manual do Usuário disponível na plataforma)
* Finalmente, explicar o qual é o trabalho que será desenvolvido. (Ler primeiro parágrafo da proposta do Trabalho Final disponível na plataforma)

## Objetivos:

1. Descrever as características das escolas e o desempenho de seus estudantes na Prova de Brasil em 2011.

2. Estimar a proporção de escolas que menos de 75% de seus estudantes participaram da Prova Brasil em 2011.

3. Estimar a proficiência média em Língua Portuguesa e em Matemática das escolas na Prova Brasil em 2011.

4. Verificar se houve melhora do resultado da Prova Brasil de 2009 para 2011. Na Prova Brasil realizada em 2009 a proficiência em Língua Portuguesa foi 184,3 e em Matemática foi 204,3.

5. Verificar se é possível afirmar que as notas em Língua Portuguesa e em Matemática são normalmente distribuídas.

6. Comparar a proficiência média em Matemática segundo o local da escola. Você diria que a proficiência em Matemática é maior em escolas urbanas?

7. Verificar se existe diferença significativa entre as notas de Língua Portuguesa e Matemática.

8. Comparar a proporção de escolas que menos de 75% de seus estudantes participaram da Prova Brasil em 2011 segundo:
a. Local da escola;
b. Região de localização da escola.

9. Verificar se:
a. Região e categoria administrativa estão associadas;
b. Tamanho da escola e tamanho do município estão associados.

10. Verificar se a nota em Língua Portuguesa é um bom indicador para predizer a nota existe em Matemática, ou
seja se estão associadas

## Metodologia:

* Comente sobre a coleta de dados da Prova Brasil: população alvo, população acessível, características levantadas e método de coleta. (Ler documento Microdados Prova Brasil 2011 - Manual do Usuário disponível na plataforma).
* Relacione as variáveis disponibilizadas na amostra que vocês receberam e classifique-as segundo o tipo.
* Comentar sobre a(s) técnica(s) de análise empregada, justificando o seu emprego e os limites para a sua aplicação.
* Especificar o(s) programa(s) utilizados na análise de dados.

## Resultados:

_Vou colocar os códigos aqui pra conseguir rodar as coisas_

```{r, include=FALSE}
# Importando pacotes
if(!require("pacman")) install.packages("pacman")
pacman::p_load(latex2exp, knitr, tidyverse)


#Lendo os dados
dados <- readxl::read_xlsx("Amostra_g04_Andre_Camila_Rita.xlsx")
dados$LOCAL <- factor(dados$LOCAL,
                      levels = c(1, 2), 
                      labels = c("Urbana", "Rural"))
dados$ADM<- factor(dados$ADM, 
                   levels = c(1, 2, 3), 
                   labels = c("Federal", "Estadual", "Municipal"))
dados$TAM_MUN<- factor(dados$TAM_MUN, 
                       levels = c(1, 2, 3, 4, 5), 
                       labels = c("<20000 hab", 
                                  "20000 a 49999 hab", 
                                  "50000 a 99999 hab", 
                                  "100000 a 999999 hab", 
                                  "1000000 ou mais"))
dados$TAM_ESCOLA<- factor(dados$TAM_ESCOLA,
                          levels = c(1, 2, 3, 4), 
                          labels = c("<25", 
                                     "25 a 49",
                                     "50 a 99",
                                     "100 ou mais"))

#Separando nossa amostra de 50
#A seed é para garantir que será a mesma toda vez que rodarem o código
set.seed(20242)
amostra <- dados %>% 
  sample_n(size = 50)
```

### Análise das variáveis

* Fazer a análise completa das variáveis pesquisadas e interpretar os resultados:

#### Quantitativas:

##### Medidas de posição, variabilidade, assimetria e curtose

```{r, echo=FALSE}
#**Medidas de: MATRICULADOS, PARTICIPACAO, NOTA_LP e NOTA_MT**
# Funcoes auxiliares
curtose <- function(values) (quantile(values, 0.75) - quantile(values, 0.25))/(2*(quantile(values, 0.9) - quantile(values, 0.1))) # calculo q achamos num PDF de uma aula na internet

curtose_definicao <- function(values)
{
  n <- length(values)
  m <- mean(values)
  s <- sqrt((n-1) / n) * sd(values) # precisa ser o desvio populacional, por algum motivo
  
  ((sum(((values - m)^4)/n)) / (s^4))
}

excesso_curtose <- function(values)
{
  n <- length(values)
  m <- mean(values)
  s <- sqrt((n-1) / n) * sd(values) # precisa ser o desvio populacional, por algum motivo
  
  ((sum(((values - m)^4)/n)) / (s^4)) - 3 # a curtose de uma normal padrao e igual a 3
}

assimetria_corrigida_pearson <- \(values) # Ainda e uma funcao so q com uma notacao diferente, function() == \()
{
  n = length(values) # usando igual so por noia, mas e a msma coisa de usar o <-
  m = mean(values)
  s = sd(values)
  
  (sqrt((n * (n - 1)) / (n - 2))) * (sum(((values - m)^3)/n) / s^3)
  # quanto mais perto de zero mais simetrico, 
  # quanto mais negativo mais assimetrico pra esquerda
  # quanto mais positivo mais assimetrico pra direita
}

medidas_resumo_quantitativasD <- dados %>%
  select(MATRICULADOS, PARTICIPACAO, NOTA_LP, NOTA_MT) %>%
  pivot_longer(everything()) %>% 
  group_by(name) %>%
  summarise(`Média` = mean(value),
            `Desvio Padrão` = sd(value),
            `Minimo` = min(value),
            `Q1` = quantile(value, 0.25),
            `Mediana` = median(value),
            `Q3` = quantile(value, 0.75), 
            `Máximo` = max(value),
            `Excesso de Curtose` = excesso_curtose(value), 
            `Assimetria` = assimetria_corrigida_pearson(value)) %>%
  column_to_rownames(var = "name") %>%
  as.matrix() %>%
  t() %>%
  as.data.frame() %>%
  rownames_to_column(var = "Medida") %>% 
  rename(`N de matriculados` = MATRICULADOS,
         `Participação` = PARTICIPACAO,
         `Nota de Lingua Portuguesa` = NOTA_LP,
         `Nota de Matemática` = NOTA_MT)

kable(medidas_resumo_quantitativasD, 
      digits = 2,
      caption = "Medidas resumo do N de matriculados, porcentagem de participação, notas de Lingua Portuguesa e Matemática, para a amostra de 200")

medidas_resumo_quantitativasA <- amostra %>%
  select(MATRICULADOS, PARTICIPACAO, NOTA_LP, NOTA_MT) %>%
  pivot_longer(everything()) %>% 
  group_by(name) %>%
  summarise(`Média` = mean(value),
            `Desvio Padrão` = sd(value),
            `Minimo` = min(value),
            `Q1` = quantile(value, 0.25),
            `Mediana` = median(value),
            `Q3` = quantile(value, 0.75), 
            `Máximo` = max(value),
            `Excesso de Curtose` = excesso_curtose(value), 
            `Assimetria` = assimetria_corrigida_pearson(value)) %>%
  column_to_rownames(var = "name") %>%
  as.matrix() %>%
  t() %>%
  as.data.frame() %>%
  rownames_to_column(var = "Medida") %>% 
  rename(`N de matriculados` = MATRICULADOS,
         `Participação` = PARTICIPACAO,
         `Nota de Lingua Portuguesa` = NOTA_LP,
         `Nota de Matemática` = NOTA_MT)

kable(medidas_resumo_quantitativasA,
      digits = 2,
      caption = "Medidas resumo do N de matriculados, porcentagem de participação, notas de Lingua Portuguesa e Matemática, para a amostra de 50")


```

  As tabelas vão ser usadas como referencia nas seguintes análises das variáveis qualitativas, todos os dados usados abaixo foram retirados dela.


###### Matriculados:

####### Ramo-e-folhas

```{r, echo=FALSE}
#Ramo-efolhas:
cat(Filter(function(s) grepl("decimal|\\|.*[0-9]", s),
           capture.output(stem(dados$MATRICULADOS, scale = 2))),
    sep="\n")

cat(Filter(function(s) grepl("decimal|\\|.*[0-9]", s),
           capture.output(stem(amostra$MATRICULADOS, scale = 3))),
    sep="\n")

```

  Na amostra de 200 observações podemos testemunhar que a maioria das escolas tiveram menos de 100 matriculados, entretanto os dados variam entre 20 matriculados e 277, o que explica o desvio padrão ser de 42.53. 
    E na amostra de 50  isso se permanece verdade, com a maioria das escolas tendo menos de 70 matriculados, com a quantidade entre 23 e 223 matriculados, com o desvio padrão diminuindo um pouco para 42.09.


####### Distribuição de frequências com intervalos de classe

```{r, echo=FALSE, out.width='.49\\linewidth', fig.width=3, fig.height=3, fig.show='hold', fig.align='center', fig.cap="Distribuição de frequências por intervalos de classe dos números de matriculados para as amostras de tamanho $n$", fig.subcap=c("n = 200", "n = 50")}

#Distribuição de frequências com intervalos de classe
dados %>%
  mutate(mat = cut(MATRICULADOS, breaks = c(0, 25, 50, 100, Inf), 
                   labels = c("<25", "25 a 49","50 a 99","100 ou mais"))) %>%
  ggplot() +
  geom_bar(aes(x = mat), fill= "#663399") +
  labs(title = "", y= "Quantidade", x= "Matriculados")

amostra %>%
  mutate(mat = cut(MATRICULADOS, breaks = c(0, 25, 50, 100, Inf), 
                   labels = c("<25", "25 a 49","50 a 99","100 ou mais"))) %>%
  ggplot() +
  geom_bar(aes(x = mat), fill= "#663399") +
  labs(title = "", y= "Quantidade", x= "Matriculados")
```

  Os gráficos acima reforçam a ideia anterior, acrescentando que na amostra de 200 observações a maioria das escolas tiveram entre 25 e 99 matriculados, o que explica a média ser de 62.27.
    E na amostra de 50 escolas visualizamos melhor que existem poucas escolas com menos de 25 matriculados, o que explica o leve aumento da média para 66.94.


####### Histograma

```{r, echo=FALSE, out.width='.49\\linewidth', fig.width=3, fig.height=3, fig.show='hold', fig.align='center', fig.subcap=c("n = 200", "n = 50"), fig.cap="titulo"}
#Histograma
dados %>%
  ggplot() +
  geom_histogram(aes(x = MATRICULADOS,
                     y = after_stat(density)), 
                 bins =  10,
                 fill= "#663399")+
  labs(title = "", y= "Densidade", x= "Matriculados")

amostra %>%
  ggplot() +
  geom_histogram(aes(x = MATRICULADOS,
                     y = after_stat(density)), 
                 bins =  10,
                 fill= "#663399")+
  labs(title = "", y= "Densidade", x= "Matriculados")
```

  Observando o histograma de 200 observações, que se assemelha ao gráfico de uma exponencial negativa, o que causa uma assimetria Positiva de valor 26.65. O histograma de 50 escolas comporta de forma semelhante, porém a assimetria diminui para 11.56.


####### Boxplot

```{r, echo=FALSE, out.width='.49\\linewidth', fig.width=3, fig.height=3, fig.show='hold', fig.align='center', fig.subcap=c("n = 200", "n = 50"), fig.cap="titulo"}
#Boxplot
dados %>%
  ggplot() +
  geom_boxplot(aes(y = MATRICULADOS),
               fill= "#663399")+
  labs(title = "", y= "Quantidade de Matriculados", x= "")

amostra %>%
  ggplot() +
  geom_boxplot(aes(y = MATRICULADOS),
               fill= "#663399")+
  labs(title = "", y= "Quantidade de Matriculados", x= "")
```

  Contemplando o primeiro Boxplot e os dados da tabela _medidas_resumo_quantitativasD_ sabemos que o a Mediana é 49, o Q3 é 77 e o Máximo é 277, este valor alto para o máximo se comparado à média e a amostra ser de 200 escolas explica a quantidade de outliers.
  Já o Segundo Boxplot, e os dados da tabela _medidas_resumo_quantitativasA_, principalmente em comparação ao primeiro percebemos que a Mediana subiu para 56, o Q3 se mantém o mesmo e o Máximo desceu para 223, o que se explica pela amostra ser menor.


###### Participação

####### Ramo-e-folhas

```{r, echo=FALSE}
#Ramo-e-folhas
cat(Filter(function(s) grepl("decimal|\\|.*[0-9]", s),
           capture.output(stem(dados$PARTICIPACAO, scale= 2))),
    sep="\n")


cat(Filter(function(s) grepl("decimal|\\|.*[0-9]", s),
           capture.output(stem(amostra$PARTICIPACAO, scale = 0.5))),
    sep="\n")

```

  O Ramo-e-folhas da participação, por estar em porcentagem já apresenta o comportamento contrário ao de Matriculados, tendo a maior parte dos dados acima de 80 para ambas as amostras, e com o desvio padrão significantemente menor, sendo de 9.01 para a amostra maior cai para 8.61 para a menor.


####### Distribuição de frequências com intervalos de classe

```{r, echo=FALSE, out.width='.49\\linewidth', fig.width=3, fig.height=3, fig.show='hold', fig.align='center', fig.subcap=c("n = 200", "n = 50"), fig.cap="titulo"}
#Distribuição de frequências com intervalos de classe
dados %>%
  mutate(part = cut(PARTICIPACAO, breaks = seq(50, 100, length.out = 3), 
                    labels = c("< 75 %", "75% ou mais"))) %>%
  ggplot() +
  geom_bar(aes(x = part), fill= "#663399")+
  labs(title = "", y= "Quantidade", x= "Matriculados")

amostra %>%
  mutate(part = cut(PARTICIPACAO, breaks = seq(50, 100, length.out = 3), 
                    labels = c("< 75 %", "75% ou mais"))) %>%
  ggplot() +
  geom_bar(aes(x = part), fill= "#663399")+
  labs(title = "", y= "Quantidade", x= "Matriculados")
```

  Os gráficos acima nos permitem visualizar melhor as observações feitas pelo Ramo-e-Folhas, e constatar que as amostras tem comportamentos muito semelhantes, com médias quase iguais de 90.25, para a amostra "grande", e 90.06, para a amostra "pequena".


####### Histograma

```{r, echo=FALSE, out.width='.49\\linewidth', fig.width=3, fig.height=3, fig.show='hold', fig.align='center', fig.subcap=c("n = 200", "n = 50"), fig.cap="titulo"}
#Histograma
dados %>%
  ggplot() +
  geom_histogram(aes(x = PARTICIPACAO,
                     y = after_stat(density)), 
                 bins =  10,
                 fill= "#663399")+
  labs(title = "", y= "Densidade", x= "Participacao")

amostra %>%
  ggplot() +
  geom_histogram(aes(x = PARTICIPACAO,
                     y = after_stat(density)), 
                 bins =  10,
                 fill= "#663399")+
  labs(title = "", y= "Densidade", x= "Participacao")
```

  A distribuição das amostras se assemelham a uma exponencial, ou seja, com uma assímetria Negativa de -21.24 (para a amostra de 200) e -9.65 (para a amostra de 50). A diferença do primeiro gráfico  para o segundo nos leva a acreditar que a Participação da população pode se comportar como uma normal assimétrica para a esquerda.


####### Boxplot

```{r, echo=FALSE, out.width='.49\\linewidth', fig.width=3, fig.height=3, fig.show='hold', fig.align='center', fig.subcap=c("n = 200", "n = 50"), fig.cap="titulo"}
#Boxplot
dados %>%
  ggplot() +
  geom_boxplot(aes(y = PARTICIPACAO), fill= "#663399")+
  labs(title = "", y= "% de Participacao", x= "")

amostra %>%
  ggplot() +
  geom_boxplot(aes(y = PARTICIPACAO), fill= "#663399")+
  labs(title = "", y= "% de Participacao", x= "")

```

  Os Boxplot nos permitem melhor visualizar a porcentagem de participação é maior do que 90 para as amostras. A maior amostra tem o Q1 e o Q3 quase simétricos equivalentes a 86.25 e 97.05, respectivimente.
  O Boxplot da amostra menor tendo o Q1 equivalente a 85.79, a maior diferença do primeiro Boxplot para o segundo é a quantidade de outiliers, o com maior presença sendo o da amostra maior.


###### Notas Lingua Portuguesa

####### Ramo-e-folhas

```{r, echo=FALSE}
#Ramo-e-folhas
cat(Filter(function(s) grepl("decimal|\\|.*[0-9]", s),
           capture.output(stem(dados$NOTA_LP))),
    sep="\n")

cat(Filter(function(s) grepl("decimal|\\|.*[0-9]", s),
           capture.output(stem(amostra$NOTA_LP))),
    sep="\n")

```

  As notas de Lingua Portuguesa para a amostra maior estão entre 134.64 e 237.47, com desvio padrão de 21.33 e sua distribuição assemelhando-se a uma normal. Já a outra amostra está entre 140.47 e 221.23, com desvio padrão de 20.67 com caracteristicas bem similares às da amostra maior.


####### Distribuição de frequências com intervalos de classe

```{r, echo=FALSE, out.width='.49\\linewidth', fig.width=3, fig.height=3, fig.show='hold', fig.align='center', fig.subcap=c("n = 200", "n = 50"), fig.cap="titulo"}

#Distribuição de frequências com intervalos de classe
dados %>%
  mutate(nota = cut(NOTA_LP, breaks = seq(100, 250, 50))) %>%
  ggplot() +
  geom_bar(aes(x = nota), fill= "#663399")+
  labs(title = "", y= "Quantidade", x= "Nota Lingua Portuguesa")

amostra %>%
  mutate(nota = cut(NOTA_LP, breaks = seq(100, 250, 50))) %>%
  ggplot() +
  geom_bar(aes(x = nota), fill= "#663399")+
  labs(title = "", y= "Quantidade", x= "Nota Lingua Portuguesa")
```

   A maior parte das notas de Lingua Portuguesa se encontram entre 150 e 200 pontos, sendo esse o comportamento de ambas as amostras. 


####### Histograma

```{r, echo=FALSE, out.width='.49\\linewidth', fig.width=3, fig.height=3, fig.show='hold', fig.align='center', fig.subcap=c("n = 200", "n = 50"), fig.cap="titulo"}
#Histograma
dados %>%
  ggplot() +
  geom_histogram(aes(x = NOTA_LP,
                     y = after_stat(density)), 
                 fill = "#663399", 
                 alpha = 0.9, 
                 bins = 10) +
  geom_function(fun = \(x)dnorm(x, mean = mean(dados$NOTA_LP), sd = sd(dados$NOTA_LP)), 
                linewidth = 1) +
  labs(title = "", y= "Densidade", x= "Nota Lingua Portugesa")

amostra %>%
  ggplot() +
  geom_histogram(aes(x = NOTA_LP,
                     y = after_stat(density)), 
                 fill = "#663399", 
                 alpha = 0.9, 
                 bins = 10) +
  geom_function(fun = \(x)dnorm(x, mean = mean(amostra$NOTA_LP), sd = sd(amostra$NOTA_LP)), 
                linewidth = 1) +
  labs(title = "", y= "Densidade", x= "Nota Lingua Portuguesa")
```

  Os histogramas acima se assemelham a uma normal Leptocurtica, tendo a linha preta presente para evidenciar esse comportamento.


####### Boxplot

```{r, echo=FALSE, out.width='.49\\linewidth', fig.width=3, fig.height=3, fig.show='hold', fig.align='center', fig.subcap=c("n = 200", "n = 50"), fig.cap="titulo"}
#Boxplot
dados %>%
  ggplot() +
  geom_boxplot(aes(y = NOTA_LP), fill= "#663399")+
  labs(title = "", y= "Nota de Lingua Portuguesa", x= "")


amostra %>%
  ggplot() +
  geom_boxplot(aes(y = NOTA_LP), fill= "#663399")+
  labs(title = "", y= "Nota de Lingua Portuguesa", x= "")
```

  Os Boxplot não apresentam outliers, tendo os Quartis simétricos, o da amostra maior tem o Q1 levemente maior, assim como os Limites.


###### Notas Matemática

####### Ramo-e-folhas

```{r, echo=FALSE}
#Ramo-e-folhas
cat(Filter(function(s) grepl("decimal|\\|.*[0-9]", s),
           capture.output(stem(dados$NOTA_MT))),
    sep="\n")

cat(Filter(function(s) grepl("decimal|\\|.*[0-9]", s),
           capture.output(stem(amostra$NOTA_MT))),
    sep="\n")
```

  As notas de Matematica estão entre 154 e 270, sendo então maiores do que as de Lingua Portuguesa, com sua distribuição assemelhando-se a uma normal, estando bem distribuidas nas amostras.

####### Distribuição de frequências com intervalos de classe

```{r, echo=FALSE, out.width='.49\\linewidth', fig.width=3, fig.height=3, fig.show='hold', fig.align='center', fig.subcap=c("n = 200", "n = 50"), fig.cap="titulo"}
#Distribuição de frequências com intervalos de classe
dados %>%
  mutate(nota = cut(NOTA_MT, breaks = seq(150, 300, 50))) %>%
  ggplot() +
  geom_bar(aes(x = nota), fill= "#663399")+
  labs(title = "", y= "Quantidade", x= "Nota Matemática")

amostra %>%
  mutate(nota = cut(NOTA_MT, breaks = seq(150, 300, 50))) %>%
  ggplot() +
  geom_bar(aes(x = nota), fill= "#663399") +
  labs(title = "", y= "Quantidade", x= "Nota Matemática")
```



####### Histograma

```{r, echo=FALSE, out.width='.49\\linewidth', fig.width=3, fig.height=3, fig.show='hold', fig.align='center', fig.subcap=c("n = 200", "n = 50"), fig.cap="titulo"}

#Histograma
media = mean(dados$NOTA_MT)
desvio  = sd(dados$NOTA_MT)
dados %>%
  ggplot() +
  geom_histogram(aes(x = NOTA_MT,
                     y = after_stat(density)),
                 fill = "#663399",
                 alpha = 0.9,
                 bins = 10) +
  geom_function(fun = \(x)dnorm(x, mean = mean(dados$NOTA_MT), sd = sd(dados$NOTA_MT)), 
                linewidth = 1)+
  labs(title = "", y= "Densidade", x= "Nota Matematica")

media = mean(amostra$NOTA_MT)
desvio  = sd(amostra$NOTA_MT)
amostra %>%
  ggplot() +
  geom_histogram(aes(x = NOTA_MT,
                     y = after_stat(density)),
                 fill = "#663399",
                 alpha = 0.9,
                 bins = 10) +
  geom_function(fun = \(x)dnorm(x, mean = mean(amostra$NOTA_MT), sd = sd(amostra$NOTA_MT)), 
                linewidth = 1)+
  labs(title = "", y= "Densidade", x= "Nota Matematica")
```

####### Boxplot

```{r, echo=FALSE, out.width='.49\\linewidth', fig.width=3, fig.height=3, fig.show='hold', fig.align='center', fig.subcap=c("n = 200", "n = 50"), fig.cap="titulo"}
#Boxplot
dados %>%
  ggplot() +
  geom_boxplot(aes(y = NOTA_MT), fill= "#663399")+
  labs(title = "", y= "Nota de Lingua Portuguesa", x= "")

amostra %>%
  ggplot() +
  geom_boxplot(aes(y = NOTA_MT), fill= "#663399")+
  labs(title = "", y= "Nota de Lingua Portuguesa", x= "")

```

#### Categóricas

* Apresente as variáveis categóricas em forma tabular e gráfica. Comente os resultados.
  
###### Região

###### Local

###### Tamanho do município

###### Administração

###### Tamanho da escola

### Análise preliminar dos Objetivos
* Fazer uma análise preliminar dos objetivos 2 a 10 (isto é, o que vocês esperam encontrar) com base na análise descritiva realizada.

### Técnicas de Análise
* Para cada objetivo comentar sobre a(s) técnica(s) de análise empregada, justificando o seu emprego e os limites para sua aplicação. Comentar os resultados obtidos.

#### Objetivo 1

* Descrever as características das escolas e o desempenho de seus estudantes na Prova

```{r, echo=FALSE, out.width='.49\\linewidth', fig.width=3, fig.height=3, fig.show='hold', fig.align='center', fig.subcap=c("n = 200", "n = 50"), fig.cap="titulo"}
#**OBJETIVO 1**
#**Descrever as características das escolas e o desempenho de seus estudantes na Prova**


kable(table(dados$REG))
dados %>%
  ggplot() +
  geom_bar(aes(x = REG), fill="#663399") +
  labs(y= "Quantidade", x= "Regiao")

table(amostra$REG)
amostra %>%
  ggplot() +
  geom_bar(aes(x = REG), fill="#663399")+
  labs(y= "Quantidade", x= "Regiao")
```


```{r, echo=FALSE, out.width='.49\\linewidth', fig.width=3, fig.height=3, fig.show='hold', fig.align='center', fig.subcap=c("n = 200", "n = 50"), fig.cap="titulo"}

table(dados$LOCAL)
dados %>%
  ggplot() +
  geom_bar(aes(x = LOCAL), fill= "#663399")+
  labs(y= "Quantidade", x= "Local")

table(amostra$LOCAL)
amostra %>%
  ggplot() +
  geom_bar(aes(x = LOCAL), fill= "#663399")+
  labs(y= "Quantidade", x= "Local")
```


```{r, echo=FALSE, out.width='.49\\linewidth', fig.width=3, fig.height=3, fig.show='hold', fig.align='center', fig.subcap=c("n = 200", "n = 50"), fig.cap="titulo"}

table(dados$TAM_MUN)
dados %>%
  ggplot() +
  geom_bar(aes(x = TAM_MUN), fill= "#663399")+
  labs(y= "Quantidade", x= "Tamanho do Municipio")

table(amostra$TAM_MUN)
amostra %>%
  ggplot() +
  geom_bar(aes(x = TAM_MUN), fill= "#663399")+
  labs(y= "Quantidade", x= "Tamanho do muncipio")

```


```{r, echo=FALSE, out.width='.49\\linewidth', fig.width=3, fig.height=3, fig.show='hold', fig.align='center', fig.subcap=c("n = 200", "n = 50"), fig.cap="titulo"}

table(dados$ADM)
dados %>%
  ggplot() +
  geom_bar(aes(x = ADM), fill= "#663399")+
  labs(y= "Quantidade", x= "Administracao")

table(amostra$ADM)
amostra %>%
  ggplot() +
  geom_bar(aes(x = ADM), fill= "#663399")+
  labs(y= "Quantidade", x= "Administracao")
```


```{r, echo=FALSE, out.width='.49\\linewidth', fig.width=3, fig.height=3, fig.show='hold', fig.align='center', fig.subcap=c("n = 200", "n = 50"), fig.cap="titulo"}

table(dados$TAM_ESCOLA)
dados %>%
  ggplot() +
  geom_bar(aes(x = TAM_ESCOLA), fill= "#663399")+
  labs(y= "Quantidade", x= "Tamanho da Escola")

table(amostra$TAM_ESCOLA)
amostra %>%
  ggplot() +
  geom_bar(aes(x = TAM_ESCOLA), fill= "#663399")+
  labs(y= "Quantidade", x= "Tamanho da Escola")
```

#### Objetivo 2

* Estimar a proporção de escolas que menos de 75% de seus estudantes participaram da Prova


```{r, echo=FALSE}
#**OBJETIVO 2**
#Risco máximo de 5%
alpha <- 0.05
N <- nrow(dados)

dados <- dados %>%
  mutate(part75 = PARTICIPACAO < 75)
p_sum <- sum(dados$part75)
p_test <- prop.test(p_sum, n = N, conf.level=1-alpha)

amostra <- amostra %>%
  mutate(part75 = PARTICIPACAO < 75)
p_sum <- sum(amostra$part75)
p_test <- prop.test(p_sum, n = N, conf.level=1-alpha)


p_test$conf.int
p_test$estimate

```

#### Objetivo 3

```{r, echo=FALSE}
```

#### Objetivo 4

* Verificar se houve melhora do resultado da Prova Brasil de 2009 para 2011.

```{r, echo=FALSE}
#**OBJETIVO 4**
#**Na Prova realizada em 2009 a proficiência em LP foi 184,3 e em MT 204,3.**

# h0: nota LP de 2011 e menor ou igual a nota LP de 2009
# h1: nota LP de 2011 e maior que a nota LP de 2009
t.test(dados$NOTA_LP, mu=184.3, alternative = "greater", conf.level = 1-alpha)
t.test(amostra$NOTA_LP, mu=184.3, alternative = "greater", conf.level = 1-alpha)
# resultado: como p-valor = 0.4545 > 0.05, não rejeitamos h0
# nao encontramos evidencias para acreditar que houve melhora na nota de LP entre  2009 e 2011

# h0: nota MT de 2011 e menor ou igual a nota MT de 2009
# h1: nota MT de 2011 e maior que a nota MT de 2009
t.test(dados$NOTA_MT, mu=204.3, alternative = "greater", conf.level = 1-alpha)
t.test(amostra$NOTA_MT, mu=204.3, alternative = "greater", conf.level = 1-alpha)
# resultado: como p-valor = 0.6328 > 0.05, não rejeitamos h0
# nao encontramos evidencias para acreditar que houve melhora na nota de MT entre  2009 e 2011
```

#### Objetivo 5

```{r, echo=FALSE}
```

#### Objetivo 6

```{r, echo=FALSE}
```

#### Objetivo 7

```{r, echo=FALSE}
```

#### Objetivo 8

*Comparar a proporção de escolas que menos de 75% de seus estudantes participaram da Prova segundo:

Local da escola; Região de localização da escola.

```{r, echo=FALSE}
#**OBJETIVO 8**

dados %>%
  filter(part75) %>%
  select(LOCAL, REG) %>%
  group_by(LOCAL, REG) %>%
  summarise(count = n())

amostra %>%
  filter(part75) %>%
  select(LOCAL, REG) %>%
  group_by(LOCAL, REG) %>%
  summarise(count = n())


Dlocal <- dados %>%
  pull(LOCAL)

Alocal <- amostra %>%
  pull(LOCAL)


Dregiao <- dados %>% 
  pull(REG)

Aregiao <- amostra %>% 
  pull(REG)


part75D <- dados %>%
  pull(part75)

part75A <- amostra %>%
  pull(part75)

tabela1D <- table(part75D, Dlocal)
tabela1D

tabela1A <- table(part75A, Alocal)
tabela1A

# h0: as proporcoes entre escolas que tiveram menos de 75% de alunos inscritos e mais é igual entre os locais
# h1: as proporcoes entre escolas que tiveram menos de 75% de alunos inscritos e mais é diferente entre os locais
chisq.test(tabela1D)
chisq.test(tabela1A)
# Ele vai smp dar a mensagem de aviso
# conclusao: não encontramos evidencias para acreditar que a proporcao de esculas nos locais muda entre as escolas com mais e menos de 75% de inscritos

tabela2D <- table(part75D, Dregiao)
tabela2D

tabela2A <- table(part75A, Aregiao)
tabela2A

chisq.test(tabela2D)
chisq.test(tabela2A)
# conclusao: nao rejeitamos H0, acreditamos que as proporcoes sejam iguais

```

#### Objetivo 9

```{r, echo=FALSE}
```

#### Objetivo 10

* Verificar se a nota em LP é um bom indicador para predizer a nota existe em MT, ou seja se estão associadas


```{r, echo=FALSE, out.width='.49\\linewidth', fig.width=3, fig.height=3, fig.show='hold', fig.align='center', fig.subcap=c("n = 200", "n = 50"), fig.cap="titulo"}
#**OBJETIVO 10**

Dfit <- lm(NOTA_MT ~ NOTA_LP,  data = dados)
# summary(fit) # Não colocar esse summary pq vcs nao vao saber interpretar a regressao


dados %>%
  ggplot() +
  geom_point(aes(x = NOTA_LP, y = NOTA_MT), color= "#663399") +
  geom_abline(slope = Dfit$coefficients[2], intercept = Dfit$coefficients[1],
              color = "black") +
  labs(y= "Nota de Lingua Portugesa", x= "Nota de Matematica")


Afit <- lm(NOTA_MT ~ NOTA_LP,  data = amostra)

amostra %>%
  ggplot() +
  geom_point(aes(x = NOTA_LP, y = NOTA_MT), color= "#663399") +
  geom_abline(slope = Afit$coefficients[2], intercept = Afit$coefficients[1], 
              color = "black") +
  labs(y= "Nota de Lingua Portugesa", x= "Nota de Matematica")



cor.test(dados$NOTA_MT, dados$NOTA_LP, alternative="two.sided", method="pearson", conf.level=1-alpha)
cor.test(amostra$NOTA_MT, amostra$NOTA_LP, alternative="two.sided", method="pearson", conf.level=1-alpha)
# conclusao: Rejeitamos H0, ou seja, temos fortes indicios de que a correlação é diferente de zero

```

## Conclusão:

* Resumo dos resultados descritos no tópico anterior, destacando as principais descobertas com relação aos objetivos propostos do trabalho.
* Comentar dificuldades encontradas e possíveis desdobramentos do trabalho.

## Referências Bibliográficas:

[Assimetria e Curtose](https://www.itl.nist.gov/div898/handbook/eda/section3/eda35b.htm#:~:text=Skewness%20is%20a%20measure%20of,relative%20to%20a%20normal%20distribution.)

[Gráfico de Ramo e folhas](https://stackoverflow.com/questions/46535805/r-stem-and-leaf-plot-issue)

## Apêndice:

(main.R) (É para o André colocar os códigos dele ali tbm)

André: importante colocar o echo= False para não aparecer os códigos
já deixei o troço montado pra vc poder só dar ctrl+c ctrl+v
```{r, echo=FALSE, out.width='.49\\linewidth', fig.width=3, fig.height=3, fig.show='hold', fig.align='center', fig.subcap=c("n = 200", "n = 50"), fig.cap="titulo"}}
```
